#ifndef __RS485_H
#define __RS485_H
#include "usart.h"
#include "stdio.h"
#include <string.h>
#include <stdint.h>
#include "circle_buffer.h"

extern UART_HandleTypeDef huart4_485;

/*收发模式控制*/
#define RS485_TX_EN  HAL_GPIO_WritePin(GPIOB,GPIO_PIN_3,GPIO_PIN_SET);
#define RS485_RX_EN  HAL_GPIO_WritePin(GPIOB,GPIO_PIN_3,GPIO_PIN_RESET); 
static uint8_t READ_BUF1[]={0x01,0x03,0x00,0x00,0x00,0x02,0xC4,0x0B};
static uint8_t READ_BUF2[]={0x02,0x03,0x00,0x00,0x00,0x02,0xC4,0x38};
static uint8_t READ_BUF3[]={0x03,0x03,0x00,0x00,0x00,0x02,0xC5,0xE9};
static uint8_t READ_BUF4[]={0x04,0x03,0x00,0x00,0x00,0x02,0xC4,0xE5};
static uint8_t READ_BUF5[]={0x05,0x03,0x00,0x00,0x00,0x02,0xC5,0x8F};
static uint8_t READ_BUF6[]={0x06,0x03,0x00,0x00,0x00,0x02,0xC5,0xBC};
static uint8_t READ_BUF7[]={0x07,0x03,0x00,0x00,0x00,0x02,0xC4,0x6D};
static uint8_t READ_BUF8[]={0x08,0x03,0x00,0x00,0x00,0x02,0xC4,0x92};
static uint8_t READ_BUF9[]={0x09,0x03,0x00,0x00,0x00,0x02,0xC5,0x43};
static uint8_t READ_BUF10[]={0x10,0x03,0x00,0x00,0x00,0x02,0xC7,0x4A};
static uint8_t* READ_BUF[10]={READ_BUF1,READ_BUF2,READ_BUF3,READ_BUF4,READ_BUF5,READ_BUF6,READ_BUF7,READ_BUF8,READ_BUF9,READ_BUF10};
static uint8_t RS485_RX_BUF[10];
static uint8_t RS485_RX_CNT=0; 


void RS485_Receive_Data(uint8_t *buf,uint8_t *len);
void Process_data(uint8_t *buf,uint8_t len);
void RS_Change_Baud(int Baud);
float *RS485_Run(int i);
static int CRC16_MODBUS(uint8_t *buf,uint8_t len); 
#endif
